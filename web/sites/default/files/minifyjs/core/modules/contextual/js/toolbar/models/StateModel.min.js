(function(Drupal,Backbone){Drupal.contextualToolbar.StateModel=Backbone.Model.extend({defaults:{isViewing:!0,isVisible:!1,contextualCount:0,tabbingContext:null,},initialize(attrs,options){this.listenTo(options.contextualCollection,'reset remove add',this.countContextualLinks,);this.listenTo(options.contextualCollection,'add',this.lockNewContextualLinks,);this.listenTo(this,'change:contextualCount',this.updateVisibility);this.listenTo(this,'change:isViewing',(model,isViewing)=>{options.contextualCollection.each((contextualModel)=>{contextualModel.set('isLocked',!isViewing)})})},countContextualLinks(contextualModel,contextualCollection){this.set('contextualCount',contextualCollection.length)},lockNewContextualLinks(contextualModel,contextualCollection){if(!this.get('isViewing')){contextualModel.set('isLocked',!0)}},updateVisibility(){this.set('isVisible',this.get('contextualCount')>0)},},)})(Drupal,Backbone)