module.exports={'@tags':['core','ckeditor5'],before(browser){browser.drupalInstall({installProfile:'testing'}).drupalInstallModule('ckeditor5',!0).drupalInstallModule('field_ui').drupalInstallModule('node',!0);browser.resizeWindow(1920,1080)},after(browser){browser.drupalUninstall()},'Ensure CKEditor respects field widget row value':(browser)=>{browser.drupalLoginAsAdmin(()=>{browser.drupalRelativeURL('/admin/config/content/formats/add').waitForElementVisible('[data-drupal-selector="edit-name"]').updateValue('[data-drupal-selector="edit-name"]','test').waitForElementVisible('#edit-name-machine-name-suffix').click('[data-drupal-selector="edit-editor-editor"] option[value=ckeditor5]',).waitForElementVisible('[data-drupal-selector="edit-editor-settings-toolbar"]',).click('.ckeditor5-toolbar-button-sourceEditing').perform(function(){return this.actions().sendKeys(browser.Keys.ARROW_DOWN)}).waitForElementVisible('[href*=edit-editor-settings-plugins-ckeditor5-sourceediting]',).submitForm('input[type="submit"]').waitForElementVisible('[data-drupal-messages]').assert.textContains('[data-drupal-messages]','Added text format').drupalRelativeURL('/admin/structure/types/add').waitForElementVisible('[data-drupal-selector="edit-name"]').updateValue('[data-drupal-selector="edit-name"]','test').waitForElementVisible('#edit-name-machine-name-suffix').submitForm('input[type="submit"]').waitForElementVisible('[data-drupal-messages]').assert.textContains('[data-drupal-messages]','The content type test has been added',).drupalRelativeURL('/node/add/test').waitForElementVisible('.ck-editor__editable').execute(function(){const height=document.querySelector('.ck-editor__editable',).clientHeight;return height>300},[],(result)=>{browser.assert.ok(result.value,'Editor height is set to 9 rows (default).',)},).click('.ck-source-editing-button').waitForElementVisible('.ck-source-editing-area').execute(function(){const height=document.querySelector('.ck-source-editing-area',).clientHeight;return height>300},[],(result)=>{browser.assert.ok(result.value,'Source editing height is set to 9 rows (default).',)},).drupalRelativeURL('/node/add/test').execute(function(){window.Drupal.CKEditor5Instances.forEach((instance)=>{instance.setData('<p>Llamas are cute.</p>'.repeat(100))});const height=document.querySelector('.ck-editor__editable',).clientHeight;return height<window.innerHeight},[],(result)=>{browser.assert.ok(result.value,'Editor area should never exceed full viewport.',)},).click('.ck-source-editing-button').waitForElementVisible('.ck-source-editing-area').execute(function(){function isScrollableY(element){const style=window.getComputedStyle(element);if(element.scrollHeight>element.clientHeight&&style.overflow!=='hidden'&&style['overflow-y']!=='hidden'&&style.overflow!=='clip'&&style['overflow-y']!=='clip'){if(element===document.scrollingElement||(style.overflow!=='visible'&&style['overflow-y']!=='visible')){return!0}}
return!1}
return isScrollableY(document.querySelector('.ck-source-editing-area textarea'),)},[],(result)=>{browser.assert.strictEqual(result.value,!0,'Source Editor textarea should have vertical scrollbar when needed.',)},).drupalRelativeURL('/admin/structure/types/manage/test/form-display').waitForElementVisible('[data-drupal-selector="edit-fields-body-settings-edit"]',).click('[data-drupal-selector="edit-fields-body-settings-edit"]').waitForElementVisible('[data-drupal-selector="edit-fields-body-settings-edit-form-settings-rows"]',).updateValue('[data-drupal-selector="edit-fields-body-settings-edit-form-settings-rows"]','18',).click('[data-drupal-selector="edit-fields-body-settings-edit-form-actions-save-settings"]',).waitForElementVisible('[data-drupal-selector="edit-fields-body"] .field-plugin-summary',).click('[data-drupal-selector="edit-submit"]').waitForElementVisible('[data-drupal-messages]').assert.textContains('[data-drupal-messages]','Your settings have been saved',).drupalRelativeURL('/node/add/test').execute(function(){const height=document.querySelector('.ck-editor__editable',).clientHeight;return height>600},[],(result)=>{browser.assert.ok(result.value,'Editor height is set to 18 rows.')},).click('.ck-source-editing-button').waitForElementVisible('.ck-source-editing-area').execute(function(){const height=document.querySelector('.ck-source-editing-area',).clientHeight;return height>600},[],(result)=>{browser.assert.ok(result.value,'Source editing height is set to 18 rows (default).',)},)})},}