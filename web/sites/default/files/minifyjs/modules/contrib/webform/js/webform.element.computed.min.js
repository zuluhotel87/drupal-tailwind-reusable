(function($,Drupal,once){Drupal.webform=Drupal.webform||{};Drupal.webform.computed=Drupal.webform.computed||{};Drupal.webform.computed.delay=Drupal.webform.computed.delay||500;var computedElements=[];Drupal.behaviors.webformComputed={attach:function(context){$(once('webform-computed','.js-webform-computed',context)).each(function(){var $element=$(this);var $form=$element.closest('form');var id=$form.attr('id')+'-'+$element.find('input[type="hidden"]').attr('name');var elementKeys=$(this).data('webform-element-keys').split(',');if(!elementKeys){return}
var inputs=[];$.each(elementKeys,function(i,key){inputs.push(':input[name="'+key+'"]');inputs.push(':input[name^="'+key+'["]')});var triggers=inputs.join(',');computedElements.push({id:id,element:$element,form:$form,triggers:triggers});$element.attr('data-webform-computed-last','')});$.each(computedElements,function(index,computedElement){var $triggers=$(context).find(computedElement.triggers);if(!$triggers.length){return}
$triggers=$(once('webform-computed-triggers-'+computedElement.id,computedElement.form.find($triggers)));if(!$triggers.length){return}
initializeTriggers(computedElement.element,$triggers)});function initializeTriggers($element,$triggers){$triggers.on('keyup change',queueUpdate);var $draggable=$triggers.closest('tr.draggable');if($draggable.length){$draggable.find('.tabledrag-handle').on('mouseup pointerup touchend',queueUpdate)}
queueUpdate();var timer=null;function queueUpdate(){if(timer){window.clearTimeout(timer);timer=null}
timer=window.setTimeout(triggerUpdate,Drupal.webform.computed.delay)}
function triggerUpdate(){var $wrapper=$element.find('.js-webform-computed-wrapper');if($wrapper.hasClass('webform-computed-loading')){queueUpdate();return}
var formValues=$triggers.serialize();var previousValues=$element.attr('data-webform-computed-last');if(previousValues===formValues){return}
$element.attr('data-webform-computed-last',formValues);$wrapper.addClass('webform-computed-loading');$element.find('.js-form-submit').trigger('mousedown')}}}}})(jQuery,Drupal,once)