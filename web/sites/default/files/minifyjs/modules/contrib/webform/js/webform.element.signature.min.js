(function($,Drupal,debounce,once){Drupal.webform=Drupal.webform||{};Drupal.webform.signaturePad=Drupal.webform.signaturePad||{};Drupal.webform.signaturePad.options=Drupal.webform.signaturePad.options||{};Drupal.behaviors.webformSignature={attach:function(context){if(!window.SignaturePad){return}
$(once('webform-signature','input.js-webform-signature',context)).each(function(){var $input=$(this);var value=$input.val();var $wrapper=$input.parent();var $canvas=$wrapper.find('canvas');var $button=$wrapper.find(':button, :submit');var canvas=$canvas[0];var refresh=function(){var $details=$canvas.parents('details:not([open])');$details.attr('open','open');$canvas.attr('width',$wrapper.width());$canvas.attr('height',$wrapper.width()/3);signaturePad.clear();var value=$input.val();if(value){signaturePad.fromDataURL(value)}
$details.removeAttr('open')};var options=$.extend({onEnd:function(){$input.val(signaturePad.toDataURL())}},Drupal.webform.signaturePad.options);var signaturePad=new SignaturePad(canvas,options);if($input.is(':disabled')||$input.is('[readonly]')){signaturePad.off();$button.hide()}
$(window).on('resize',debounce(refresh,10));$input.closest('form').on('webform_cards:change',refresh);$button.on('click',function(){signaturePad.clear();$input.val('');$(this).trigger('blur');return!1});$input.on('change',function(){setTimeout(refresh,1)});$input.on('webform:disabled webform:readonly',function(){if($input.is(':disabled')||$input.is('[readonly]')){signaturePad.off();$button.hide()}else{signaturePad.on();$button.show()}});setTimeout(refresh,1)})}}})(jQuery,Drupal,Drupal.debounce,once)