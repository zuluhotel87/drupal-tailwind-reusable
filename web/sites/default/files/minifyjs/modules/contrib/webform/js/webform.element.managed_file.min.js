(function($,Drupal,once){Drupal.behaviors.webformManagedFileAutoUpload={attach:function attach(context){$(once('webform-auto-file-upload','form',context)).on('submit',function(event){var $form=$(this);if($form.data('webform-auto-file-uploads')>0&&Drupal.webformManagedFileBlockSubmit($form)){event.preventDefault();return!1}
return!0});if(typeof Drupal.Ajax!=='undefined'&&typeof Drupal.Ajax.prototype.beforeSubmitWebformManagedFileAutoUploadOriginal==='undefined'){Drupal.Ajax.prototype.beforeSubmitWebformManagedFileAutoUploadOriginal=Drupal.Ajax.prototype.beforeSubmit;Drupal.Ajax.prototype.beforeSubmit=function(form_values,element_settings,options){var $form=this.$form;var $element=$(this.element);var isFormActions=$element.closest('.form-actions').length;var isMultipleUpload=$element.parents('.js-form-type-webform-multiple, .js-form-type-webform-custom-composite').find('.js-form-managed-file').length;var isManagedUploadButton=$element.parents('.js-form-managed-file').length;if($form.data('webform-auto-file-uploads')>0&&(isFormActions||(isMultipleUpload&&!isManagedUploadButton))&&Drupal.webformManagedFileBlockSubmit($form)){this.ajaxing=!1;return!1}
return this.beforeSubmitWebformManagedFileAutoUploadOriginal.apply(this,arguments)}}
$(once('webform-auto-file-upload','input[type="file"]',context)).on('change',function(){$(this).data('webform-auto-file-upload',!0);var $form=$(this.form);var fileUploads=($form.data('webform-auto-file-uploads')||0);$form.data('webform-auto-file-uploads',fileUploads+1)})},detach:function detach(context,settings,trigger){if(trigger==='unload'){const removedElements=once.remove('webform-auto-file-upload','input[type="file"]',context);$(removedElements).each(function(){if($(this).data('webform-auto-file-upload')){$(this).removeData('webform-auto-file-upload');var $form=$(this.form);var fileUploads=($form.data('webform-auto-file-uploads')||0);$form.data('webform-auto-file-uploads',fileUploads-1)}})}}};Drupal.webformManagedFileBlockSubmit=function(form){if($(form).data('webform-auto-file-uploads')<0){return!1}
var message=Drupal.t('File upload in progress. Uploaded file may be lost.')+'\n'+Drupal.t('Click OK to submit the form without finishing the file upload or cancel to return to form.');var result=!window.confirm(message);if(result&&Drupal.behaviors.webformSubmitOnce){setTimeout(function(){Drupal.behaviors.webformSubmitOnce.clear()})}
return result}})(jQuery,Drupal,once)